
\noindent
APBSmem funciona por defecto a través de una interfaz gráfica, pero esto puede resultar limitante, pues el resultado entregado es una energía de solvatación entre estados fijos, y hasta donde se sabe, no hay forma de modificar esto por GUI. Afortunadamente se puede trabajar con APBSmem mediante terminal, lo que permite un mayor grado de flexibilidad a la hora de realizar cálculos.\\\\
Se presenta a continuación una estructura de trabajo que se puede aplicar para obtener los resultados de APBSmem utilizando solo una de sus rutinas acoplada al programa APBS base; esto está basado en un post en un foro oficial de sourceforge por parte de uno de los desarrolladores de APBSmem. También se explica paso a paso las acciones que realiza cada parte de este instructivo, al menos según el entendimiento del autor.

\begin{enumerate}
	\item En primer lugar hay que correr APBSmem con cualquier configuración de parámetros (la que viene por defecto, por ejemplo). Para esto, lo único que se requiere es importar un archivo \texttt{.pqr} mediante la opción \textit{Browse} en la parte superior de la interfaz gráfica, y luego correr la simulación (\textit{Run}). Se pide especificar un directorio en el que escribir los archivos de salida\footnote{Se debe tener cuidado, pues para simulaciones con una malla fina (y por ende densa), cada archivo sobrepasa fácilmente un GB de espacio}; esto crea una carpeta con varios documentos, de los cuales interesan los siguientes:
	\begin{itemize}
		\item \textit{archivo}\texttt{.dummy.in}: Este archivo tiene un solo bloque, y se encarga de escribir mapas de permitividad ($\varepsilon$), carga ($q$), e inverso de la longitud de Debye ($\kappa$) en formato .dx.
		\item \texttt{diel\_1.dx}: Es un set de ficheros que contienen la permitividad eléctrica en todos los puntos del dominio, \textbf{sin consideración de la membrana}. Se generan tres archivos (\texttt{dielx, diely, dielz}), pero hasta donde se sabe son los tres iguales, pues se considera que el tensor $\varepsilon_{i,j}$ es diagonal e isotrópico.\footnote{No se han hecho pruebas para comprobar otros casos, por lo que el hecho de que los tres archivos sean \textbf{siempre} iguales no es definitivo.}
		\item \texttt{charge\_1.dx}: Es un archivo con la densidad de carga en todos los puntos del dominio.
		\item \texttt{kappa\_1.dx}: Es un archivo con los mapas de accesibilidad iónica en todos los puntos del dominio.
		\item \textit{archivo}\texttt{.solv.in} Este archivo tiene dos bloques que corresponden a los dos estados cuyas energías se desean calcular para obtener así la energía de solvatación a partir de la diferencia de las primeras. Este archivo está preparado para que APBS importe los tres sets de mapas mencionados \textbf{con} consideración de la membrana.
	\end{itemize}
	\item Con los archivos anteriores listos, se puede prescindir de la GUI de APBSmem. Lo que sigue es modificar el archivo \texttt{.dummy.in} para dejarlo con las propiedades físicas de interés. Como este archivo entrega un mapa sin membrana, lo que se ingresa son las propiedades del solvente y de la proteína sabiendo que después una parte del solvente será remplazada para acoplar la membrana. Es importante que el número de nodos en el dominio sea consistente entre este archivo y el \texttt{.solv.in}; de lo contrario, existe un conflicto al correr APBS por razones evidentes. Correr APBS sobre \texttt{.dummy.in} no realiza cálculos, solo sirve para escribir los mapas que se utilizan posteriormente. Para lograr esto, simplemente se debe correr por terminal el \textit{ejecutable} (binario) \texttt{apbs} con archivo de entrada \textit{archivo}\texttt{.dummy.in}, y los mapas se escribirán en el directorio desde el que se está ejecutando apbs\footnote{En el directorio desde el que está actuando la terminal, \textbf{NO} el directorio donde esta el binario de apbs}. Alternativamente, se puede definir el directorio de salida para el set de archivos como segundo argumento de \texttt{apbs}.\\\\
	\begin{lstlisting}
	/apbs_bin_directory/apbs archivo.dummy.in
	\end{lstlisting}
	\item Una vez impresos los mapas, se debe llamar a la subrutina de APBSmem que genera un nuevo set de mapas con inclusión de la membrana. Para esto, se debe tener descomprimido APBSmem, además de tener JRE (Java Runtime Environment) en el equipo. Para el trabajo presente, este programa solo se utilizó para modificar la permitividad (la accesibilidad ya era $0$ en todo el dominio) de los puntos correspondientes al interior de la membrana, pero hay una serie de argumentos válidos, como por ejemplo espesor de las cabezas hidrofílicas y su permitividad, entre otros. Para incluir la membrana, se debe estar operando en el directorio donde están mapas dieléctricos; el comando es el siguiente (no se deben considerar los saltos de línea, son por tema de espacio solamente):
	\begin{lstlisting}
java -cp /apbsmem_directory/apbsmem.jar
apbsmem.DrawMembrane out-directory
z_m0 l_m pdie sdie mdie idie V I R_m1 R_m0 a0 flood focus
	\end{lstlisting}
	\texttt{z\_m0} corresponde a la coordenada sobre el eje Z en la cual se coloca la membrana. Hay que recordar que la membrana está conformada por el espacio entre dos interfaces planas infinitas, con vectores normales $(0, 0, \pm 1)$.\\
	\texttt{l\_m} es el espesor de dicha membrana, por lo que la interfaz superior se encuentra en $z =$ \texttt{z\_m0} + \texttt{l\_m}.\\
	\texttt{(p,s,m,i)die} son la permitividad de la proteína, solvente, membrana, y cabezas fosfolipídicas, respectivamente. El programa busca todos los puntos que corresponden a solvente y las remplaza por la permitividad de la membrana y $\kappa = 0$ si es que están en el dominio designado para la membrana. Se desconoce cómo se incluye el efecto de las cabezas, pues siempre se las trabajó con espesor 0.\\
	\texttt{V} es el potencial de membrana \textbf{reducido}. La fórmula de potencial reducido está en la publicación correspondiente a APBSmem \cite{APBSmem}, pero para una temperatura de $298.15\, K$, se puede dividir el potencial en $[mV]$ directamente por $25.69$ para obtener el potencial reducido.\\
	\texttt{I} corresponde a la concentración de iones. Se considera una concentración simétrica de iones (misma de \textit{ions} que de \textit{counterions}).\\
	\texttt{R\_m(1,0)} son los radios de exclusión superior e inferios. No se utilizaron estas opciones durante este trabajo, por lo que se desconoce su implicancia en la escritura de los mapas modificados. Sin embargo, existe información sobre su aplicación en el artículo asociado a APBSmem \cite{APBSmem}, en donde se indica que se utiliza para evitar que, en casos con solvente encerrado por la proteína de alguna forma, el programa sobreescriba esos puntos como membrana.\\
	\texttt{a0} especifica el espesor de las cabezas hidrofílicas de la membrana, en $\angstrom$.\\
	\texttt{flood} es un booleano, que define si se emplea el método flooding. Este método permite al programa identificar el solvente a remplazar como todo lo que este alrededor y por fuera de la proteína, evitando así sobreescribir cavidades y canales de paso como membrana.\\
	\texttt{focus} corresponde al nivel de focusing que se utiliza para la generación del set de mapas. Hay más información al respecto en \cite{pdb2pqr_1} sobre el método de focusing.
	\item 
\end{enumerate}